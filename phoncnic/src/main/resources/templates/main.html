<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<style>
    html,
    body {
        max-height: 100%;
    }

    #nav {
        background-color: transparent !important;
    }

    .containerBox {
        font-family: "NeoDunggeunmo";
    }

    .phoncnic {
        font-size: 120px;
        text-align: center;
        padding: 10px;
        color: black;
        text-shadow: 9px 0 #fff, 0 1px #fff, 1px 0 #fff, 0 -1px #fff;
        letter-spacing: 5px;
    }

    .containerBox button {
        font-family: "NeoDunggeunmo";
        font-size: 40px;
        padding: 20px;
    }

    .buttonItems {
        margin: 0 auto;
    }

    #wrapper {
        background-image: url([[@{/icon/pixel-main.jpg}]]);
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
    }

    .button-background {
        background-image: url([[@{/icon/main-button.png}]]);
        background-size: 276px 81px;
        background-position: center;
        background-repeat: no-repeat;
        /* width: 315px;
      height: 114px; */
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 8px 0;
    }

    .buttonItems button {
        border: none;
        background-color: transparent;
        padding: 15px 50px;
    }

    .avartar img {
        filter: drop-shadow(4px 2px 1px black);
    }

    .show-avartar-con {
        margin-left: 85px;
        height: 140px;
        display: flex;
        align-items: center;
        /* font-family: GmarketsansLight; */
    }

    .avartar-hover {
        display: none;
        position: relative;
        background: #fff;
        border-radius: .4em;
        width: 130px;
        font-size: 16px;
        text-align: center;
        bottom: 230px;
        left: 10px;
    }

    .avartar-hover:after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 50%;
        width: 0;
        height: 0;
        border: 24px solid transparent;
        border-top-color: #fff;
        border-bottom: 0;
        margin-left: -24px;
        margin-bottom: -24px;
    }

    .avartar:hover~.avartar-hover {
        display: block;
    }

    .avartar-speech-bubble-background {
        background-image: url([[@{/icon/avartar-bubble.png}]]);
        background-repeat: no-repeat;
        background-size: cover;
        background-position: center;
        display: flex;
        width: 946px;
        flex-flow: column;
        justify-content: space-evenly;
        align-items: center;
        height: 213px;
    }

    .avartar-speech-bubble-con {
        display: none;
    }

    .show {
        display: block;
    }

    .remove {
        display: none;
    }

    .avartar-speech-bubble-background button {
        width: 78px;
        height: 40px;
        font-size: 18px;
        padding: 5px;
        margin-bottom: 15px;
        border: 1px solid black;
    }

    .avartar-speech-bubble-text {
        width: 83%;
        word-break: keep-all;
        padding-top: 25px;
    }

    .speech-bubble-btn-con {
        display: flex;
        align-items: center;
        justify-content: end;
        width: 80%;
    }

    .basic-main-logo {
        display: none;
    }

    .fa-solid:hover {
        cursor: pointer;
    }

    /* Ïñ∏Ïñ¥Î≥ÄÌôò css */
    /* The switch - the box around the slider */
    .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
        vertical-align: middle;
        margin-left: 3rem;
    }

    /* Hide default HTML checkbox */
    .switch input {
        display: none;
    }

    /* The slider */
    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
        
    }

    .slider:before {
        position: absolute;
        content: "";
        height: 26px;
        width: 26px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        -webkit-transition: .4s;
        transition: .4s;
    }

    input:checked+.slider {
        background-color: #ffc107;
    }

    input:focus+.slider {
        box-shadow: 0 0 1px #ffc107;
    }

    input:checked+.slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
        border-radius: 34px;
    }

    .slider.round:before {
        border-radius: 50%;
    }

    p {
        margin: 0px;
        display: inline-block;
        font-size: 15px;
        font-weight: bold;
    }
</style>
<th:block th:replace="~{layout/basic :: setContent(~{::content})}">
    <th:block th:fragment="content">
        <input type="text" name="loginUserId" th:value="${loginuserId}" hidden>
        <div class="containerBox">
            <!-- Ïñ∏Ïñ¥Î≥ÄÌôò -->
            <label class="switch">
                <input type="checkbox" id="slide-langu">
                <span class="slider round"></span>
            </label>
            <p>ÌïúÍ∏Ä</p>
            <p style="display:none;">ÏòÅÏñ¥</p>

            <div class="phoncnic">phoncnic</div>
            <div class="buttonItems">
                <div class="button-background">
                    <div class="button-text">
                        <!-- ÌîºÌÅ¨ÎãâÍ∞àÎ¶ºÍ∏∏ -->
                        <a th:href="@{/crossroad}"><button type="button" class="text-langu" data-text-index="0">Start</button></a>
                    </div>
                </div>
                <div class="button-background" sec:authorize="isAnonymous()">
                    <div class="button-text">
                        <a th:href="@{/member/login}"><button type="button" class="text-langu" data-text-index="1">Login</button></a>
                    </div>
                </div>
                <div class="button-background" sec:authorize="isAuthenticated()">
                    <div class="button-text">
                        <a th:href="@{/reception}"><button type="button" class="text-langu" data-text-index="2">Change Role</button></a>
                    </div>
                </div>
                <div class="button-background" sec:authorize="hasAnyRole('ROLE_CEO', 'ROLE_ADMIN', 'ROLE_ARTIST')">
                    <div class="button-text">
                        <a th:href="@{/manage/rolechoice}"><button type="button" class="text-langu" data-text-index="3">Management</button></a>
                    </div>
                </div>
                <div class="button-background">
                    <div class="button-text">
                        <a><button type="button" id="how-button" class="text-langu" data-text-index="4">How to play</button></a>
                    </div>
                </div>
            </div>

            <div class="show-avartar-con">
                <div class="show-avartar">
                    <div class="avartar">
                        <button type="button" class="btn " id="btncharacterlook" data-bs-toggle="modal"
                            data-bs-target="#modalcharacterlook">
                            <img id="userAvatar" th:src="${avatar?.setpath}" alt="üôÑ" width="100px">
                        </button>
                    </div>
                    <div class="avartar-hover">
                        ÌÅ¥Î¶≠Ìï¥ÏÑú Ï∫êÎ¶≠ÌÑ∞Î•º Î≥ÄÍ≤ΩÌï¥Î≥¥ÏÑ∏Ïöî!
                    </div>
                </div>
                <div class="avartar-speech-bubble-con remove" id="bubble-con">
                    <div class="avartar-speech-bubble-background">
                        <div class="avartar-speech-bubble-text">
                            <!-- ÎÇ¥Ïö©Îì§Ïñ¥Í∞à Í≥≥  -->
                        </div>
                        <div class="speech-bubble-btn-con">
                            <button type="button" id="speech-prebtn">Ïù¥Ï†Ñ</button>
                            <button type="button" id="speech-okbtn">ÌôïÏù∏</button>
                        </div>
                    </div>
                </div>
                <div style="font-size: 40px; margin-bottom: 235px; color: white;" id="speech-bubble-x"><i
                        class="fa-solid fa-square-xmark"></i></div>
            </div>
        </div>

        <script th:inline="javascript">

            $(function (e) {
                // Ïñ∏Ïñ¥Î≥ÄÌôò
                var HangullagnuArr = ["ÏãúÏûëÌïòÍ∏∞","Î°úÍ∑∏Ïù∏", "Ïã†ÏõêÎ≥ÄÍ≤Ω", "Í¥ÄÎ¶¨ÌïòÍ∏∞","Ï¶êÍ∏∞ÎäîÎ≤ï"];
                var EnglishlagnuArr = ["Start","Login","Change Role","Mangement","How to play"];

                var check = $("#slide-langu");
                var triger = false;
                check.click(function () {
                    $("p").toggle();
                    if(!triger){
                        $(".text-langu").each((index, item)=>{
                            var textIndex = item.dataset.textIndex;
                            // console.log(HangullagnuArr[textIndex]);
                            item.innerHTML=HangullagnuArr[textIndex];
                            $(".phoncnic").text("Ìè∞-ÌÅ¨Îãâ.v1");
                        });
                        triger = true;
                    } else {
                        $(".text-langu").each((index, item)=>{
                            var textIndex = item.dataset.textIndex;
                            // console.log(EnglishlagnuArr[textIndex]);
                            item.innerHTML=EnglishlagnuArr[textIndex];
                            $(".phoncnic").text("phoncnic");
                        });
                        triger = false;
                    }
                });

                /*[+ var crossroad =  [[@{/crossroad}]]  +]*/

                //ÏïÑÎ∞îÌÉÄ ÎßêÌíçÏÑ† ÌôïÏù∏Î≤ÑÌäº ÌÅ¥Î¶≠ Ïãú ÏÑ§Î™ÖÏÑú ÎùÑÏõÄ
                var avartarBubble = {
                    0: "PhoncnicÏóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§ ^-^",
                    1: "PhoncnicÏùÄ ÎπÑÎåÄÎ©¥ÏúºÎ°ú Î¨∏Ìôî ÏÉùÌôúÏùÑ Ï¶êÍ∏∏ Ïàò ÏûàÎäî ÏÇ¨Ïù¥Ìä∏ÏûÖÎãàÎã§. Ïù¥Ïö©ÏûêÎäî Ïò®ÎùºÏù∏ Ï†ÑÏãúÌöåÎ•º ÌÜµÌï¥ ÏûëÌíàÏùÑ Í∞êÏÉÅÌï† Ïàò ÏûàÍ≥†," +
                        " Î∞•Ïßë, Ïπ¥ÌéòÍ±∞Î¶¨ÏóêÏÑú Í∞ÄÍ≤å Ï†ïÎ≥¥Î•º ÏñªÏùÑ Ïàò ÏûàÏñ¥Ïöî :)",
                    2: "Í∞§Îü¨Î¶¨ÏóêÏÑú ÏûëÌíàÏóê Ï¢ãÏïÑÏöîÎ•º ÎÇ®Í∏∞Í≥† ÏûëÍ∞ÄÎ•º ÌåîÎ°úÏö∞ Ìï† Ïàò ÏûàÏúºÎ©∞, Í∞ÄÍ≤å Í±∞Î¶¨ÏóêÏÑúÎäî Î∞©Ìñ•ÌÇ§Î°ú Ï∫êÎ¶≠ÌÑ∞Î•º ÏõÄÏßÅÏó¨ Î∞•Ïßë, Ïπ¥Ìéò Í±∞Î¶¨Î•º ÌÉêÎ∞©ÏùÑ Ìï† Ïàò ÏûàÎãµÎãàÎã§",
                    3: "ÏûëÍ∞Ä, ÏÇ¨ÏóÖÏûê Ïã†Ï≤≠ÎèÑ Ïñ∏Ï†úÎì†ÏßÄ Î∞õÍ≥†ÏûàÏñ¥Ïöî! ÏûëÍ∞ÄÍ∞Ä ÎêòÏñ¥ÏÑú ÏûêÏã†Ïùò ÏûëÌíàÏùÑ ÏÇ¨ÎûåÎì§Í≥º Í≥µÏú†Ìï¥Î≥¥Í≥†, ÏÇ¨ÏóÖÏûêÎùºÎ©¥ ÏûêÏã†Ïùò Í∞ÄÍ≤åÎ•º Îì±Î°ùÌï¥ Í∞ÄÍ≤å ÌôçÎ≥¥ Í∏∞ÌöåÎ•º ÎßàÎ†®Ìï¥Î≥¥ÏÑ∏Ïöî!",
                    4: "Í∑∏Îüº Phoncnic Ï¶êÍ∏∞Îü¨ Í∞ÄÎ≥¥Ïã§ÍπåÏöî? o(„ÄÉÔºæ‚ñΩÔºæ„ÄÉ)o",
                    5: "<a href='/phoncnic/crossroad' style='color:black;'>Phoncnic ÏÇ∞Ï±ÖÍ∞ÄÍ∏∞</a>",
                }


                $("#speech-okbtn").on("click", speechBubbleNext);
                $("#speech-prebtn").on("click", speechBubblePre);

                var i = 0;
                $("#speech-prebtn").css("display", "none");
                $("#speech-okbtn").css("display", "block");

                function buttonChecker(pageNumber) {
                    if (pageNumber == 0) {
                        $("#speech-okbtn").css("display", "block");
                        $("#speech-prebtn").css("display", "none");
                    } else if (pageNumber == 5) {
                        $("#speech-okbtn").css("display", "none");
                    } else {
                        $("#speech-okbtn").css("display", "block");
                        $("#speech-prebtn").css("display", "block");
                    }
                }

                function speechBubbleNext() {
                    $(".avartar-speech-bubble-text").html(avartarBubble[i + 1]);
                    i++;
                    buttonChecker(i);
                    console.log("next:" + i);
                };

                function speechBubblePre() {
                    $(".avartar-speech-bubble-text").html(avartarBubble[i - 1]);
                    i--;
                    buttonChecker(i);
                    console.log("pre:" + i);
                }

                //ÏÑ§Î™ÖÏÑú ÎùÑÏõÄ
                var howBtn = $("#how-button");
                $("#speech-bubble-x").addClass("remove");
                howBtn.on("click", function () {
                    if ($("#bubble-con").attr("class") == "avartar-speech-bubble-con remove") {
                        $("#bubble-con").removeClass("remove");
                        $("#bubble-con").addClass("show");
                        $(".avartar-speech-bubble-text").html(avartarBubble[0]);
                        $("#speech-bubble-x").removeClass("remove");
                        $("#speech-bubble-x").addClass("show");
                        buttonChecker(0);
                    } else {
                        $("#bubble-con").removeClass("show");
                        $("#bubble-con").addClass("remove");
                        $("#speech-bubble-x").removeClass("show");
                        $("#speech-bubble-x").addClass("remove");

                    }
                });

                $("#speech-bubble-x").on("click", function () {
                    $("#bubble-con").removeClass("show");
                    $("#bubble-con").addClass("remove");
                    $("#speech-bubble-x").removeClass("show");
                    $("#speech-bubble-x").addClass("remove");

                });

                /*[+
                    var lookModalUrl =  [[@{/character/lookmodal}]];
                    var lookModifyUrl = [[@{/character/lookmodify}]];
                +]*/

                var modalBody = $(".character-modal-body");
                var showLookModal = function (e) {
                    var str = '';
                    $.get(lookModalUrl, function (result) {
                        console.log(result);
                        $.each(result[0], function (index, item) {
                            str += `<span>
                                        <input id="${index}${item.setname}" name="chalookInfo" type="radio" value="${item.setname}" hidden>
                                        <label for="${index}${item.setname}">
                                            <img src="${item.setpath}" id="setimg" alt="">
                                        </lable>
                                    </span>`
                        });

                        str += `<form id="lookfrm" action="" hidden>
                            <input type="hidden" name="id" value="${result[1]}">
                            <input type="hidden" name="setname" value="${result[2].setname}">
                            <input type="hidden" name="setpath" value="${result[2].setpath}">
                            <div class="look">
                                    <div>
                                        <img class="setlook newsetlook" src="${result[2].setpath}" alt="" id="checkedset">
                                    </div>
                                </div>
                            </form>`;
                        modalBody.html(str);
                        $('input:radio[name=chalookInfo]:input[value=' + result[2].setname + ']').attr("checked", true);
                    });
                    console.log("get look modal success...");
                }

                var modifyLook = function () {
                    var setname = $("input[name=setname]").val();
                    var setpath = $("input[name=setpath]").val();
                    var data = { setname: setname, setpath: setpath };
                    // console.log(data);
                    $.ajax({
                        type: "post",
                        url: lookModifyUrl,
                        data: JSON.stringify(data),
                        contentType: "application/json",
                        success: function (response) {
                            swal('success', "Î≥ÄÍ≤ΩÏôÑÎ£å", { button: false, timer: 1000 });
                            $("#userAvatar").attr("src", setpath);
                        },
                        fail: function (response) {
                            // console.log(response);
                        }, error: function (request, status, error) {
                            // console.log(request);
                        }
                    });
                }


                // Î™®Îã¨Ï†úÏñ¥
                if ($("input[name=loginUserId]").val() != "") {

                    modalBody.html("Ïû†Ïãú Í∏∞Îã§Î†§Ï£ºÏÑ∏Ïöî ... ");

                    $("#btncharacterlook").on("click", showLookModal);

                    $(document).on("change", "input[name=chalookInfo]", function () {
                        var checkRaido = $(this).val();
                        var checkedset = $(this).next().children("img").attr("src");
                        $("#checkedset").attr("src", checkedset);
                        $("input[name=setname]").val(checkRaido);
                        $("input[name=setpath]").val(checkedset);
                    });

                    $(document).on("click", "#lookModifyBtn", function () {
                        swal({
                            text: "Ï∫êÎ¶≠ÌÑ∞Ïò∑ÏùÑ Î≥ÄÍ≤ΩÌïòÏãúÍ≤†ÏäµÎãàÍπå?",
                            icon: "warning",
                            buttons: {
                                confirm: {
                                    text: "ÌôïÏù∏",
                                    value: true,
                                },
                                cancel: "Ï∑®ÏÜå",
                            },
                        }).then((check) => {
                            if (check) {
                                modifyLook();
                            } else {
                                return;
                            }
                        });
                    });
                }
            });
        </script>
        <style>
            .newsetlook {
                position: relative;
                width: 100px;
                height: 140px;
            }

            #setimg {
                width: 100px;
                height: 140px;
            }

            span>label {
                padding: 15px;
            }

            span>label:hover {
                cursor: pointer;
            }

            input[type=radio]:checked+label {
                background-color: #DBE9B7;
                border-radius: 5px;
            }

            .character-modal-body {
                display: flex;
                justify-content: center;
            }
        </style>
        <!-- Î™®Îã¨Ï∞Ω -->
        <div class="character modal" tabindex="-1" id="modalcharacterlook">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Ï∫êÎ¶≠ÌÑ∞ Î£©</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                            name="btn-close"></button>
                    </div>
                    <div class="modal-body character-modal-body">
                        <div>Î°úÍ∑∏Ïù∏ ÌõÑ Ïù¥Ïö©Ìï¥Ï£ºÏÑ∏Ïöî </div>
                    </div>
                    <div class="modal-footer">
                        <button th:if="${loginuserId}" id="lookModifyBtn" type="button"
                            class="basic-button">Î≥ÄÍ≤ΩÌïòÍ∏∞</button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                            name="btn-close">Ï∑®ÏÜå</button>
                    </div>
                </div>
            </div>
        </div>
    </th:block>
</th:block>