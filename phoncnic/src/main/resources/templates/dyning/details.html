<!DOCTYPE html>
<html lang="ko" xmls:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dyning details</title>
</head>

<body>
    <h1>dyning details</h1>
    <ul>
        <li th:each="dto : ${result}">
            [[${ dto }]]
        </li>
    </ul>

    <table border="1">
        <tr>
            <th scope="col">dyningname</th>
            <th scope="col">businesshours</th>
            <th scope="col">location</th>
            <th scope="col">comment</th>
            <th scope="col">hashtag</th>
            <th scope="col">tel</th>
            <th scope="col">menu</th>
            <th scope="col">background</th>
            <th scope="col">emojicwt</th>
    
    
        </tr>
        <tr th:each="dto : ${result}" >
            <td >[[${dto.dyningname}]]</td>
            <td >[[${dto.businesshours}]]</td>
            <td >[[${dto.location}]]</td>
            <td >[[${dto.comment}]]</td>
            <td >[[${dto.hashtag}]]</td>
            <td >[[${dto.tel}]]</td>

            <td>
                   <th:block th:each="idto : ${imageresult}">[[${idto.menuimagepath}]],</th:block> 
            </td>
            <td>
                <th:block th:each="idto : ${imageresult}">[[${idto.backgroundpath}]],</th:block> 
             </td>
             <td >[[${dto.emojicwt}]]</td>

        </tr>
    </table>
    <button type="button" id="location">ì§€ë„ Api</button>
    <style>
        #map {
            width: 100%;
            height: 400px;
            background-color: grey;
        }
    </style>
    <!-- GoogleMap API ì—°ë™ -->
    <h3>ê°€ê²Œ ìœ„ì¹˜</h3>
    <div id="map">
        <iframe height="450"
        style="border: 0ch;"
        allowfullscreen        
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChX8cJ6bEy6MWOp4-uK-KeT1m3T-9sR4M&callback=initMap&q=-33.8569,151.2152&region=KR&language=ko"
        >
        </iframe>
    </div> <!-- ì§€ë„ê°€ ë¶™ì„ ìœ„ì¹˜ -->


    <form action="">
        <input type="hidden" name="id" value="user1@icloud.com"  readonly>
        <input type="hidden" name="dno" th:value="${result.dno}">
    
        <select name="emojitype" id="">
            <option value="1">ğŸ˜‹</option>
            <option value="2">ğŸ¥°</option>
            <option value="3">ğŸ˜­</option>
            <option value="4">ğŸ˜…</option>
            <option value="5">ğŸ¥µ</option>

        </select>
        <button type="button" id="emojisave">ì´ëª¨ì§€ ì¶”ê°€í•˜ê¸°</button>

</form>
        <table border="1">
            <tr >
                <th>ì´ëª¨ì§€ ê°¯ìˆ˜</th>
                <th scope="col" colspan="5">ì´ëª¨ì§€ íƒ€ì…</th>
                <th th:colspan="${result.emojicwt}">ì´ëª¨ì§€ ì‚­ì œ</th>
            </tr>
            <tr>
                <td>[[${result.emojicwt}]]</td>
                <td>ğŸ˜‹<span>[[${emojitype1}]]</span></td>
                <td>ğŸ¥°[[${emojitype2}]]</td>
                <td>ğŸ˜­[[${emojitype3}]]</td>
                <td>ğŸ˜…[[${emojitype4}]]</td>
                <td>ğŸ¥µ[[${emojitype5}]]</td>  
                <td th:each="dto : ${emojilist}"><button type="button" th:value="${dto.eno}" class="emojiRemoveBtn">ì‚­ì œ</button></td>
            </tr>
            
            
        </table>


</body>
<script  src="http://code.jquery.com/jquery-latest.min.js"></script>
// ì•„ë˜ëŠ” ì„œë²„ë¡œë¶€í„° ì§€ë„ë¥¼ ë¡œë”©í•˜ê¸° ìœ„í•´ ìš”ì²­í•˜ëŠ” ê²½ë¡œ asyncëŠ” ë¹„ë™ê¸°ë¡œ ë¡œë”©í•˜ë„ë¡í•´ ì§€ë„ ë¡œë”© ì¤‘ ë‹¤ë¥¸ ì›¹ ë¶€ë¶„ë“¤ì´ ì—´ë¦´ ìˆ˜ ìˆë„ë¡í•˜ê¸° ìœ„í•¨
//  keyë¶€ë¶„ì—ëŠ” ìì‹ ì˜ í‚¤ë¥¼ ë„£ê³ , ë¡œë”©ì´ ì™„ë£Œë˜ë©´ callbackì— ì§€ì •í•œ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰í•˜ê²Œ ë¨.


<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyChX8cJ6bEy6MWOp4-uK-KeT1m3T-9sR4M&callback=initMap&q=ë¶€ì‚°ê´‘ì—­ì‹œ ë¶€ì‚°ì§„êµ¬ KR ë¶€ì‚°ê´‘ì—­ì‹œ ë¶€ì‚°ì§„êµ¬ ë™ì„±ì§ì—…ì „ë¬¸í•™êµ A1í”„ë¼ì 6ì¸µ&region=KR&language=ko">

        </script>

<!-- End of GoogleMap API ì—°ë™(í™©ì˜ë¡±) -->
<script>




$("#emojisave").click(function () {
    var id = $("input[name='id']").val();
    var dno = $("input[name='dno']").val();
    var emojitype = $("select[name='emojitype']").val();


var data = { id: id, dno: dno, emojitype:emojitype};
       var urlemojiregister = `[[@{/dyning/emojiregister}]]`;
        console.log(data);
$.ajax({
    url: urlemojiregister + "/" + dno,
    type: "POST",
    data: JSON.stringify(data),
    contentType: "application/json; charset=utf-8",
    dataType: "text",
    success: function (result) {
        console.log("result: " + result);
        self.location.reload();
    }
})
});


$(".emojiRemoveBtn").click( function(){
        var eno =$(this).val();
        var data = {eno:eno};

        console.log(data);
        var urlemojiremove = `[[@{/dyning/emojiremove}]]`;
        $.ajax({
            url: urlemojiremove +"/"+ eno,
            type: "DELETE",
            data: JSON.stringify(data),
            contentType: "application/json; charset=utf-8",
            dataType: "text",
            success: function (result) {
                console.log("result: " + result);
                self.location.reload();
        }
        })
    });
</script>
</html>